<!--
 * Copyright (c) 2023-2024, WSO2 LLC. (https://www.wso2.com).
 *
 * WSO2 LLC. licenses this file to you under the Apache License,
 * Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
-->

{% macro home_card_icon(icon) %}
{% if icon.endswith(".svg") or icon.endswith(".png") %}
{% include icon %}
{% else %}
{% include ".icons/" ~ icon ~ ".svg" %}
{% endif %}
{% endmacro %}

{% extends "base.html" %}
{% import "partials/cta.html" as cta %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ 'assets/css/home.css' | url }}">
{% endblock %}

{% block container %}
<div class="md-content">
  <article class="md-content__inner md-typeset">
    <div class="description-section"
      style="display: flex; flex-direction: row; align-items: flex-start; margin-top: 30px;">
      <p>
        WSO2 API Manager is a complete platform for building, integrating, and exposing your digital services as
        managed APIs in the cloud, on-premise, and hybrid architectures to drive your digital transformation strategy.
      </p>
    </div>

    <div style="display: flex; flex-direction: row; gap: 24px; align-items: center;">
      <button class="md-typeset md-button md-button--primary md-button--small md-button--flex md-button--apim"
        onclick="window.open('http://localhost:4000/en/4.6.0/ai-gateway/ai-gateway-overview/', '_blank', 'noopener')">
        Get started with AI Gateway
      </button>
      <a href="#components">Browse by Components</a>
    </div>

    {{ page.content }}

    <h2>Get Started</h2>
    <hr>
    <div class="md-home-sections">
      {% for columns in config.extra.home_page_cards %}
      {% for column in columns.section %}
      {% set header_icon_class = "md-column-grid-item-header-icon" %}
      {% if column.icon_color %}
      {% set header_icon_class = header_icon_class ~ " " ~ column.icon_color %}
      {% endif %}

      {% for item in column.list_items %}
      <div class="md-list-item-container">
        <div class="md-list-item">

          {% if item.url %}

          {% set link = item.url %}

          {% if link.startswith("http") %}

          {% set link_url = item.url %}
          {% set target = '_blank' %}

          {% else %}
          {% set nav_path_keys = link.split('|') %}

          {% set glob = {
          'nav_config': nav,
          'break_loop': false,
          'item_url': None
          } %}

          {% macro loop_children(key) %}

          {% set _ = glob.update({ 'nav_config': glob.nav_config }) %}

          {% if not glob.nav_config.url %}
          {% for nav_item in glob.nav_config %}
          {% if glob.break_loop == false %}
          {% if nav_item.title == key %}

          {% if nav_item.url %}
          {% set _ = glob.update({ 'item_url': nav_item.url }) %}
          {% endif %}

          {% if nav_item.children %}
          {% set _ = glob.update({ 'nav_config': nav_item.children }) %}

          {% set first = nav_item.children | first %}
          {% if first.title == 'Index' %}
          {% set _ = glob.update({ 'item_url': first.url }) %}
          {% endif %}
          {% else %}
          {% set _ = glob.update({ 'item_url': nav_item.url }) %}
          {% set _ = glob.update({ 'nav_config': nav_item }) %}
          {% endif %}

          {% set _ = glob.update({ 'break_loop': true }) %}

          {% endif %}
          {% endif %}
          {% endfor %}

          {% set _ = glob.update({ 'break_loop': false }) %}
          {% else %}
          {% set _ = glob.update({ 'item_url': glob.nav_config.url }) %}
          {% endif %}

          {% if glob.break_loop == true %}
          {{ loop_children(key) }}
          {% endif %}
          {% endmacro %}

          {% for key in nav_path_keys %}
          {{ loop_children(key) }}
          {% endfor %}

          {% set link_url = glob.item_url | replace('index.md', '') | replace('.md', '/') %}
          {% set target = '_self' %}

          {% endif %}

          <a href="{{ link_url }}" target="{{ target }}">
            <div class="md-list-item-icon">
              <svg width="11" height="15" viewBox="0 -3 11 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M5.95801 0.0537109L10.748 4.83643L5.95801 9.62646L5.21094 8.88672L8.76318 5.36377L0.0473633 5.34912V4.33105L8.74854 4.31641L5.21094 0.793457L5.95801 0.0537109Z">
                </path>
              </svg>
            </div>
            <div class="md-list-item-text">{{ item.title }}</div>
          </a>
          {% endif %}
        </div>
      </div>
      {% endfor %}
      {% endfor %}
      {% endfor %}
    </div>
    <h2 id="components">Components</h3>
      <hr />
      <p>WSO2 API Manager offers multiple components designed to work together to solve the challenges of diverse
        infrastructure requirements.</p>

      <div style="display: flex; justify-content: flex-end;">
        <div style="display: flex; justify-content: space-between; gap: 32px;">
          <div style="width: 48%;">
            {% if config.extra.design_and_manage_apis_cards %}
            <h3>Design & Manage APIs</h3>
            <p>Build, iterate, and apply policies to your APIs and API products.</p>
            {% for columns in config.extra.design_and_manage_apis_cards %}
            {% for column in columns.section %}
            <div class="md-card md-column-grid-item">
              <div class="md-column-grid-item-header-container">
                <div class="md-column-grid-item-header-text">
                  <h4 style="margin: 0;">{{ column.title }}</h4>
                </div>
              </div>
              {% if column.description %}
              <p>{{ column.description }}</p>
              {% endif %}
              {{ cta.render_cta('Design APIs Overview', 'api-design-manage/design/design-api-overview') }}
            </div>
            {% endfor %}
            {% endfor %}
            {% endif %}
          </div>
          <div style="width: 48%;">
            {% if config.extra.discover_apis_cards %}
            <h3>Discover APIs</h3>
            <p>Find, explore, and subscribe to APIs for your applications.</p>
            {% for columns in config.extra.discover_apis_cards %}
            {% for column in columns.section %}
            <div class="md-card md-column-grid-item">
              <div class="md-column-grid-item-header-container">
                <div class="md-column-grid-item-header-text">
                  <h4 style="margin: 0;">{{ column.title }}</h4>
                </div>
              </div>
              {% if column.description %}
              <p>{{ column.description }}</p>
              {% endif %}
              {{ cta.render_cta('Consume APIs Overview', 'api-developer-portal/consume-api-overview/') }}
            </div>
            {% endfor %}
            {% endfor %}
            {% endif %}
          </div>
          <div style="width: 48%;">
            {% if config.extra.run_apis_cards %}
            <h3>Run APIs</h3>
            <p>Deploy and manage the runtime environment for your API traffic.</p>
            {% for columns in config.extra.run_apis_cards %}
            {% for column in columns.section %}
            <div class="md-card md-column-grid-item">
              <div class="md-column-grid-item-header-container">
                <div class="md-column-grid-item-header-text">
                  <h4 style="margin: 0;">{{ column.title }}</h4>
                </div>
              </div>
              {% if column.description %}
              <p>{{ column.description }}</p>
              {% endif %}
              {% if column.cta_items %}
              <ul>
                {% for item in column.cta_items %}
                <li>
                  {{ cta.render_cta(item.cta_text, item.url) }}
                </li>
                {% endfor %}
              </ul>
              {% endif %}
            </div>
            {% endfor %}
            {% endfor %}
            {% endif %}
          </div>
        </div>


      </div>

  </article>
</div>
{% endblock %}